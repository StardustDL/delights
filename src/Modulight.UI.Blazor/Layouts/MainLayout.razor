@inherits LayoutComponentBase
@inject IBlazorUIProvider UIProvider
@inject IModuleHost ModuleHost
@inject IRazorComponentClientModuleCollection RazorComponentClientModuleCollection
@inject IServiceProvider ServiceProvider
@inject NavigationManager NavigationManager

<AntDesign.Layout Style="min-height: 100vh; background: initial;">
    <Sider Collapsible Theme="SiderTheme.Light" Breakpoint="BreakpointType.Xl" OnCollapse="OnCollapse">
        <Menu Mode="MenuMode.Inline" Theme="MenuTheme.Light">
            <MenuItem Class="text-center p-0">
                @UIProvider.SiteInfo.Name
            </MenuItem>
            @foreach (var module in UIProvider.GetVisibleClientModules())
            {
                <MenuItem OnClick="@(()=>NavigationManager.NavigateTo(module.RootPath))">
                    <AntModuleIcon Module="module"></AntModuleIcon>
                    <MenuLink Href="@module.RootPath" hidden="@IsCollapsed">@module?.Manifest.DisplayName</MenuLink>
                </MenuItem>
            }
        </Menu>
    </Sider>
    <AntDesign.Layout Style="background: initial;">
        <Content>@Body</Content>
        <Footer Class="text-center p-1">
            @if (UIProvider.Footer is not null)
            {
                @UIProvider.Footer
            }
        </Footer>
    </AntDesign.Layout>
</AntDesign.Layout>

<BackTop></BackTop>

@code{
    bool IsCollapsed { get; set; } = false;

    void OnCollapse(bool isCollapsed)
    {
        IsCollapsed = isCollapsed;
    }
}